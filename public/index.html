<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Our Research Study</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Welcome to Our Research Study</h1>
            <p class="subtitle">Climate change belief conversion narratives study</p>
        </div>
        
        <div class="content">
            <p class="intro-paragraph">You are invited to take part in a research study about how and why people change their beliefs about climate change. We are interested in hearing your story about what influenced your views.</p>
            
            <div class="section-card">
                <h2>What You'll Do</h2>
                <ul class="section-list">
                    <li>Complete a brief survey about your background and current views on climate change (2–3 minutes)</li>
                    <li>Have a short text-based conversation with a chatbot designed to guide you in telling your story (5–7 minutes)</li>
                    <li>Complete a short exit survey about your experience (2–3 minutes)</li>
                </ul>
            </div>
            
            <hr class="section-divider">
            
            <div class="section-card">
                <h2>Total Time Commitment</h2>
                <p class="commitment-text">10–15 minutes</p>
            </div>
            
            <hr class="section-divider">
            
            <div class="section-card">
                <h2>Important Information</h2>
                <ul class="section-list">
                    <li>Your responses are anonymous</li>
                    <li>You may withdraw from the study at any time</li>
                    <li>Your data will only be used for research purposes</li>
                    <li>Please answer honestly and respectfully</li>
                </ul>
            </div>
            
            <hr class="section-divider">
            
            <div class="ready-section">
                <h2>Ready to Begin?</h2>
                <form id="startForm">
                    <div class="form-group">
                        <label for="prolificId">Enter your Participant ID:</label>
                        <input type="text" id="prolificId" name="prolificId" required
                               placeholder="e.g., 12345ABCD">
                        <small>This ID was provided to you by the study administrator.</small>
                        <div class="error-message" id="idError" style="display: none; color: #e74c3c; font-size: 14px; margin-top: 5px;"></div>
                    </div>
                    
                    <button type="submit" class="btn-primary">Begin Study</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Handle Participant ID form submission
        document.getElementById('startForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const prolificId = document.getElementById('prolificId').value.trim();
            
            // Validate Participant ID
            if (!prolificId) {
                showError('Please enter your Participant ID');
                return;
            }
            
            // Check if ID is 6-32 alphanumeric characters
            const idPattern = /^[A-Za-z0-9]{6,32}$/;
            if (!idPattern.test(prolificId)) {
                showError('Participant ID must be 6–32 alphanumeric characters');
                return;
            }
            
            // Clear any previous errors
            hideError();
            
            // Store Participant ID and consent information
            sessionStorage.setItem('prolific_id', prolificId);
            const consentData = {
                timestamp: new Date().toISOString(),
                consent_given: true,
                prolific_id: prolificId
            };
            sessionStorage.setItem('consent_data', JSON.stringify(consentData));
            
            // Redirect to survey
            window.location.href = '/survey';
        });

        // Error handling functions
        function showError(message) {
            const errorElement = document.getElementById('idError');
            errorElement.textContent = message;
            errorElement.style.display = 'block';
            document.getElementById('prolificId').style.borderColor = '#e74c3c';
        }

        function hideError() {
            const errorElement = document.getElementById('idError');
            errorElement.style.display = 'none';
            document.getElementById('prolificId').style.borderColor = '#e1e8ed';
        }

        // Add real-time validation
        document.getElementById('prolificId').addEventListener('input', function() {
            hideError();
        });

        // Add keyboard accessibility - Enter key on Participant ID input triggers form submit
        document.getElementById('prolificId').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                document.getElementById('startForm').dispatchEvent(new Event('submit'));
            }
        });
    </script>
</body>
</html>